//! Licensed to the .NET Foundation under one or more agreements.
//! The .NET Foundation licenses this file to you under the MIT license.
const e=Symbol.for("wasm promise_control");function t(t,o){let n=null;const r=new Promise((function(e,r){n={isDone:!1,promise:null,resolve:o=>{n.isDone||(n.isDone=!0,e(o),t&&t())},reject:e=>{n.isDone||(n.isDone=!0,r(e),o&&o())}}}));n.promise=r;const i=r;return i[e]=n,{promise:i,promise_control:n}}function o(t){return t[e]}function n(t){if(!function(t){return void 0!==t[e]}(t))throw new Error("Assert failed: Promise is not controllable")}const r="MONO_WASM: ";function i(e,...t){T.diagnosticTracing&&console.debug(r+e,...t)}function s(e,...t){console.info(e,...t)}function a(e,...t){console.error(r+e,...t)}let c,l;function d(e,t,o){const n={log:t.log,error:t.error},r=t;function i(t,o,r){return function(...i){try{let n=i[0];if(void 0===n)n="undefined";else if(null===n)n="null";else if("function"==typeof n)n=n.toString();else if("string"!=typeof n)try{n=JSON.stringify(n)}catch(e){n=n.toString()}if("string"==typeof n)if("["==n[0]){const t=(new Date).toISOString();n="main"!==e?`[${e}][${t}] ${n}`:`[${t}] ${n}`}else"main"!==e&&(n=`[${e}] ${n}`);o(r?JSON.stringify({method:t,payload:n,arguments:i}):[t+n,...i.slice(1)])}catch(e){n.error(`proxyConsole failed: ${e}`)}}}const s=["debug","trace","warn","info","error"];for(const e of s)"function"!=typeof r[e]&&(r[e]=i(`console.${e}: `,t.log,!1));const a=`${o}/console`.replace("https://","wss://").replace("http://","ws://");c=new WebSocket(a),c.addEventListener("open",(()=>{n.log(`browser: [${e}] Console websocket connected.`)})),c.addEventListener("error",(t=>{n.error(`[${e}] websocket error: ${t}`,t)})),c.addEventListener("close",(t=>{n.error(`[${e}] websocket closed: ${t}`,t)}));const l=e=>{c.readyState===WebSocket.OPEN?c.send(e):n.log(e)};for(const e of["log",...s])r[e]=i(`console.${e}`,l,!0)}let u=0;const f={"js-module-threads":!0,"js-module-runtime":!0,"js-module-native":!0,"js-module-dotnet":!0,dotnetwasm:!0},h={dotnetwasm:!0,symbols:!0},m={resource:!0,assembly:!0,pdb:!0,heap:!0,icu:!0,"js-module-threads":!0,"js-module-runtime":!0,"js-module-native":!0,"js-module-dotnet":!0,dotnetwasm:!0},p={"js-module-threads":!0,"js-module-runtime":!0,"js-module-native":!0,"js-module-dotnet":!0,dotnetwasm:!0,symbols:!0};function g(e){return!("icu"==e.behavior&&e.name!=T.preferredIcuAsset)}function w(e){var t;const o=null===(t=T.config.assets)||void 0===t?void 0:t.find((t=>t.behavior==e));if(!o)throw new Error(`Assert failed: Can't find asset for ${e}`);return o.resolvedUrl||(o.resolvedUrl=_(o,"")),o}async function b(){i("mono_download_assets"),T.maxParallelDownloads=T.config.maxParallelDownloads||T.maxParallelDownloads,T.enableDownloadRetry=T.config.enableDownloadRetry||T.enableDownloadRetry;try{const e=[],t=[],o=[];for(const o of T.config.assets){const n=o;if("object"!=typeof n)throw new Error("Assert failed: asset must be object");if("string"!=typeof n.behavior)throw new Error("Assert failed: asset behavior must be known string");if("string"!=typeof n.name)throw new Error("Assert failed: asset name must be string");if(n.resolvedUrl&&"string"!=typeof n.resolvedUrl)throw new Error("Assert failed: asset resolvedUrl could be string");if(n.hash&&"string"!=typeof n.hash)throw new Error("Assert failed: asset resolvedUrl could be string");if(n.pendingDownload&&"object"!=typeof n.pendingDownload)throw new Error("Assert failed: asset pendingDownload could be object");m[n.behavior]?t.push(n):e.push(n)}const n=e=>{!p[e.behavior]&&g(e)&&T.expected_instantiated_assets_count++,!f[e.behavior]&&g(e)&&(T.expected_downloaded_assets_count++,o.push(y(e)))};for(const t of e)n(t);await T.runtimeModuleLoaded.promise,await R.memorySnapshotSkippedOrDone.promise;for(const e of t)if(R.loadedMemorySnapshot){if(C(e),"resource"==e.behavior||"assembly"==e.behavior||"pdb"==e.behavior){const t=_(e,""),o="string"==typeof e.virtualPath?e.virtualPath:e.name;T._loaded_files.push({url:t,file:o})}}else n(e);T.allDownloadsQueued.promise_control.resolve(),await T.runtimeModuleLoaded.promise;const r=[];for(const e of o)r.push((async()=>{const t=await e;if(t.buffer){if(!p[t.behavior]){const e=t.pendingDownloadInternal.url;if(!t.buffer||"object"!=typeof t.buffer)throw new Error("Assert failed: asset buffer must be array or buffer like");const o=new Uint8Array(t.buffer);C(t),await R.beforeOnRuntimeInitialized.promise,await R.memorySnapshotSkippedOrDone.promise,R.instantiate_asset(t,e,o)}}else if(h[t.behavior])"symbols"===t.behavior&&(await R.instantiate_symbols_asset(t),C(t)),h[t.behavior]&&++T.actual_downloaded_assets_count;else{if(!t.isOptional)throw new Error("Assert failed: Expected asset to have the downloaded buffer");!f[t.behavior]&&g(t)&&T.expected_downloaded_assets_count--,!p[t.behavior]&&g(t)&&T.expected_instantiated_assets_count--}})());Promise.all(r).then((()=>{R.allAssetsInMemory.promise_control.resolve()})).catch((e=>{T.err("Error in mono_download_assets: "+e),T.abort_startup(e,!0)}))}catch(e){throw T.err("Error in mono_download_assets: "+e),e}}async function y(e){try{return await v(e)}catch(t){if(!T.enableDownloadRetry)throw t;if(j||A)throw t;if(e.pendingDownload&&e.pendingDownloadInternal==e.pendingDownload)throw t;if(e.resolvedUrl&&-1!=e.resolvedUrl.indexOf("file://"))throw t;if(t&&404==t.status)throw t;e.pendingDownloadInternal=void 0,await T.allDownloadsQueued.promise;try{return await v(e)}catch(t){return e.pendingDownloadInternal=void 0,await(100,new Promise((e=>globalThis.setTimeout(e,100)))),await v(e)}}}async function v(e){for(;l;)await l.promise;try{++u,u==T.maxParallelDownloads&&(i("Throttling further parallel downloads"),l=t());const o=await async function(e){if(e.pendingDownload&&(e.pendingDownloadInternal=e.pendingDownload),e.pendingDownloadInternal&&e.pendingDownloadInternal.response)return e.pendingDownloadInternal.response;if(e.buffer){const t=e.buffer;return e.buffer=null,e.pendingDownloadInternal={url:"undefined://"+e.name,name:e.name,response:Promise.resolve({arrayBuffer:()=>t,headers:{get:()=>{}}})},e.pendingDownloadInternal.response}const t=e.loadRemote&&T.config.remoteSources?T.config.remoteSources:[""];let o;for(let n of t){n=n.trim(),"./"===n&&(n="");const t=_(e,n);e.name===t?i(`Attempting to download '${t}'`):i(`Attempting to download '${t}' for ${e.name}`);try{e.resolvedUrl=t;const n=E(e);if(e.pendingDownloadInternal=n,o=await n.response,!o||!o.ok)continue;return o}catch(e){o||(o={ok:!1,url:t,status:0,statusText:""+e});continue}}const n=e.isOptional||e.name.match(/\.pdb$/)&&T.config.ignorePdbLoadErrors;if(!o)throw new Error(`Assert failed: Response undefined ${e.name}`);if(!n){const t=new Error(`download '${o.url}' for ${e.name} failed ${o.status} ${o.statusText}`);throw t.status=o.status,t}T.out(`optional download '${o.url}' for ${e.name} failed ${o.status} ${o.statusText}`)}(e);return o?(h[e.behavior]||(e.buffer=await o.arrayBuffer(),++T.actual_downloaded_assets_count),e):e}finally{if(--u,l&&u==T.maxParallelDownloads-1){i("Resuming more parallel downloads");const e=l;l=void 0,e.promise_control.resolve()}}}function _(e,t){if(null==t)throw new Error(`Assert failed: sourcePrefix must be provided for ${e.name}`);let o;const n=T.config.assemblyRootFolder;if(e.resolvedUrl)o=e.resolvedUrl;else{if(""===t)if("assembly"===e.behavior||"pdb"===e.behavior)o=n?n+"/"+e.name:e.name;else if("resource"===e.behavior){const t=e.culture&&""!==e.culture?`${e.culture}/${e.name}`:e.name;o=n?n+"/"+t:t}else o=e.name;else o=t+e.name;o=T.locateFile(o),T.assetUniqueQuery&&(o+=T.assetUniqueQuery)}if(!o||"string"!=typeof o)throw new Error("Assert failed: attemptUrl need to be path or url string");return o}function E(e){try{if("function"==typeof T.downloadResource){const t=T.downloadResource(e);if(t)return t}const t={};e.hash&&(t.integrity=e.hash);const o=T.fetch_like(e.resolvedUrl,t);return{name:e.name,url:e.resolvedUrl,response:o}}catch(t){const o={ok:!1,url:e.resolvedUrl,status:500,statusText:"ERR29: "+t,arrayBuffer:()=>{throw t},json:()=>{throw t}};return{name:e.name,url:e.resolvedUrl,response:Promise.resolve(o)}}}function C(e){e.pendingDownloadInternal=null,e.pendingDownload=null,e.buffer=null}const A="object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node,O="object"==typeof window,D="function"==typeof importScripts,j=!O&&!A&&!D;let S,R=null,T=null,I=null,x=!1;const M={mono:{},binding:{},internal:{},module:{},loaderHelpers:{},runtimeHelpers:{},api:{}};function L(e,t){if(i("abort_startup"),T.allDownloadsQueued.promise_control.reject(e),T.afterConfigLoaded.promise_control.reject(e),T.wasmDownloadPromise.promise_control.reject(e),T.runtimeModuleLoaded.promise_control.reject(e),R.dotnetReady&&(R.dotnetReady.promise_control.reject(e),R.memorySnapshotSkippedOrDone.promise_control.reject(e),R.afterInstantiateWasm.promise_control.reject(e),R.beforePreInit.promise_control.reject(e),R.afterPreInit.promise_control.reject(e),R.afterPreRun.promise_control.reject(e),R.beforeOnRuntimeInitialized.promise_control.reject(e),R.afterOnRuntimeInitialized.promise_control.reject(e),R.afterPostRun.promise_control.reject(e)),"object"!=typeof e||!0!==e.silent)throw(t||j||A)&&k(1,e),e}function k(e,t){if(T.config&&T.config.asyncFlushOnExit&&0===e)throw(async()=>{try{await async function(){try{const e=await import("process"),t=e=>new Promise(((t,o)=>{e.on("error",(e=>o(e))),e.write("",(function(){t()}))})),o=t(e.stderr),n=t(e.stdout);await Promise.all([n,o])}catch(e){a(`flushing std* streams failed: ${e}`)}}()}finally{U(e,t)}})(),R.ExitStatus?new R.ExitStatus(e):t||new Error("Stop with exit code "+e);U(e,t)}function U(e,t){R.ExitStatus&&(!t||t instanceof R.ExitStatus?t?"number"==typeof t.status&&(e=t.status):t=new R.ExitStatus(e):T.config.logExitCode||(t instanceof Error&&R.stringify_as_error_with_stack?T.err(R.stringify_as_error_with_stack(t)):"string"==typeof t?T.err(t):T.err(JSON.stringify(t)))),function(e,t){if(T.config&&T.config.logExitCode)if(0!=e&&t&&(t instanceof Error&&R.stringify_as_error_with_stack?a(R.stringify_as_error_with_stack(t)):a("string"==typeof t?t:JSON.stringify(t))),c){const t=()=>{0==c.bufferedAmount?s("WASM EXIT "+e):globalThis.setTimeout(t,100)};t()}else s("WASM EXIT "+e)}(e,t);try{R.jiterpreter_dump_stats&&R.jiterpreter_dump_stats(!1)}catch(e){}if(function(e){if(O&&T.config&&T.config.appendElementOnExit){const t=document.createElement("label");t.id="tests_done",e&&(t.style.background="red"),t.innerHTML=e.toString(),document.body.appendChild(t)}}(e),0!==e||!O){if(A&&S.process)throw S.process.exit(e),t;if(!R.quit)throw t;R.quit(e,t)}}!function(e){if(x)throw new Error("Loader module already loaded");x=!0,R=e.runtimeHelpers,T=e.loaderHelpers,I=e.api,S=e.internal,Object.assign(I,{INTERNAL:S}),Object.assign(e.module,{disableDotnet6Compatibility:!0,config:{environmentVariables:{}}}),Object.assign(R,{mono_wasm_bindings_is_ready:!1,javaScriptExports:{},config:e.module.config,diagnosticTracing:!1}),Object.assign(T,{config:e.module.config,diagnosticTracing:!1,maxParallelDownloads:16,enableDownloadRetry:!0,_loaded_files:[],loadedFiles:[],actual_downloaded_assets_count:0,actual_instantiated_assets_count:0,expected_downloaded_assets_count:0,expected_instantiated_assets_count:0,afterConfigLoaded:t(),allDownloadsQueued:t(),wasmDownloadPromise:t(),runtimeModuleLoaded:t(),abort_startup:L,mono_exit:k,createPromiseController:t,getPromiseController:o,assertIsControllablePromise:n,mono_download_assets:b,resolve_asset_path:w,setup_proxy_console:d})}(M);var $="Release";class P{constructor(e,t){this.bootConfig=e,this.applicationEnvironment=t}static fromFetchResponse(e,t,o){const n=o||T.getApplicationEnvironment&&T.getApplicationEnvironment(e)||"Production";return t.modifiableAssemblies=e.headers.get("DOTNET-MODIFIABLE-ASSEMBLIES"),t.aspnetCoreBrowserTools=e.headers.get("ASPNETCORE-BROWSER-TOOLS"),new P(t,n)}static async initAsync(e,t){const o="_framework/blazor.boot.json",n=void 0!==e?e("manifest","blazor.boot.json",o,""):s(o);let r;r=n?"string"==typeof n?await s(n):await n:await s(o);const i=await r.json();return P.fromFetchResponse(r,i,t);function s(e){return fetch(e,{method:"GET",credentials:"include",cache:"no-cache"})}}}let F;function W(e){return F=F||document.createElement("a"),F.href=e,F.href}function N(e){const t=!!e.resources.pdb,o=e.debugBuild;return(t||o)&&(T.isChromium||T.isFirefox)}const B=["configuration"];class z{static async initAsync(e,t){const o=await async function(e){if(!e.cacheBootResources||"undefined"==typeof caches)return null;if(!1===window.isSecureContext)return null;const t=`dotnet-resources-${document.baseURI.substring(document.location.origin.length)}`;try{return await caches.open(t)||null}catch(e){return null}}(e);return new z(e,o,t)}constructor(e,t,o){this.bootConfig=e,this.cacheIfUsed=t,this.startOptions=o,this.usedCacheKeys={},this.networkLoads={},this.cacheLoads={}}loadResources(e,t,o){return Object.keys(e).map((n=>this.loadResource(n,t(n),e[n],o)))}loadResource(e,t,o,n){const r=this.cacheIfUsed&&!B.includes(n)?this.loadResourceWithCaching(this.cacheIfUsed,e,t,o,n):this.loadResourceWithoutCaching(e,t,o,n);return{name:e,url:W(t),response:r}}logToConsole(){const e=Object.values(this.cacheLoads),t=Object.values(this.networkLoads),o=V(e),n=V(t),r=o+n;if(0===r)return;const i=this.bootConfig.linkerEnabled?"%c":"\n%cThis application was built with linking (tree shaking) disabled. Published applications will be significantly smaller.";console.groupCollapsed(`%cdotnet%c Loaded ${q(r)} resources${i}`,"background: purple; color: white; padding: 1px 3px; border-radius: 3px;","font-weight: bold;","font-weight: normal;"),e.length&&(console.groupCollapsed(`Loaded ${q(o)} resources from cache`),console.table(this.cacheLoads),console.groupEnd()),t.length&&(console.groupCollapsed(`Loaded ${q(n)} resources from network`),console.table(this.networkLoads),console.groupEnd()),console.groupEnd()}async purgeUnusedCacheEntriesAsync(){const e=this.cacheIfUsed;if(e){const t=(await e.keys()).map((async t=>{t.url in this.usedCacheKeys||await e.delete(t)}));await Promise.all(t)}}async loadResourceWithCaching(e,t,o,n,r){if(!n||0===n.length)throw new Error("Content hash is required");const i=W(`${o}.${n}`);let s;this.usedCacheKeys[i]=!0;try{s=await e.match(i)}catch(e){}if(s){const e=parseInt(s.headers.get("content-length")||"0");return this.cacheLoads[t]={responseBytes:e},s}{const s=await this.loadResourceWithoutCaching(t,o,n,r);return this.addToCacheAsync(e,t,i,s),s}}loadResourceWithoutCaching(e,t,o,n){if(this.startOptions.loadBootResource){const r=this.startOptions.loadBootResource(n,e,t,o);if(r instanceof Promise)return r;"string"==typeof r&&(t=r)}const r={cache:"no-cache"};return"configuration"===n?r.credentials="include":r.integrity=this.bootConfig.cacheBootResources?o:void 0,fetch(t,r)}async addToCacheAsync(e,t,o,n){const r=await n.clone().arrayBuffer(),i=function(e){if("undefined"!=typeof performance)return performance.getEntriesByName(e)[0]}(n.url),s=i&&i.encodedBodySize||void 0;this.networkLoads[t]={responseBytes:s};const a=new Response(r,{headers:{"content-type":n.headers.get("content-type")||"","content-length":(s||n.headers.get("content-length")||"").toString()}});try{await e.put(o,a)}catch(e){}}}function V(e){return e.reduce(((e,t)=>e+(t.responseBytes||0)),0)}function q(e){return`${(e/1048576).toFixed(2)} MB`}var J;let H;async function Q(e,t,o){S.resourceLoader=H=await z.initAsync(e.bootConfig,null!=o?o:{}),function(e,t){const o=H.bootConfig.resources,n=[],r={};e.applicationEnvironment=t,e.assets=n,e.globalizationMode="icu",e.environmentVariables=r,e.debugLevel=N(H.bootConfig)?1:0,e.maxParallelDownloads=1e6,e.enableDownloadRetry=!1,e.mainAssemblyName=H.bootConfig.entryAssembly,Object.assign(e,{...H.bootConfig}),void 0!==H.bootConfig.startupMemoryCache&&(e.startupMemoryCache=H.bootConfig.startupMemoryCache),H.bootConfig.runtimeOptions&&(e.runtimeOptions=[...e.runtimeOptions||[],...H.bootConfig.runtimeOptions]);for(const e in o.runtimeAssets){const t=o.runtimeAssets[e];t.name=e,t.resolvedUrl=T.locateFile(e),n.push(t)}for(const e in o.assembly){const t={name:e,resolvedUrl:T.locateFile(e),hash:o.assembly[e],behavior:"assembly"};n.push(t)}if(N(H.bootConfig)&&o.pdb)for(const e in o.pdb){const t={name:e,resolvedUrl:T.locateFile(e),hash:o.pdb[e],behavior:"pdb"};n.push(t)}const i=H.startOptions.applicationCulture||navigator.languages&&navigator.languages[0],s=function(e,t){if(e.icuDataMode===J.Custom){const t=Object.keys(e.resources.runtime).filter((e=>e.startsWith("icudt")&&e.endsWith(".dat")));if(1===t.length)return t[0]}if(e.icuDataMode===J.Hybrid)return"icudt_hybrid.dat";if(!t||e.icuDataMode===J.All)return"icudt.dat";const o=t.split("-")[0];return"en"===o||["fr","fr-FR","it","it-IT","de","de-DE","es","es-ES"].includes(t)?"icudt_EFIGS.dat":["zh","ko","ja"].includes(o)?"icudt_CJK.dat":"icudt_no_CJK.dat"}(H.bootConfig,i);let a=!1;for(const e in o.runtime){const t=K(e);if("icu"===t){if(H.bootConfig.icuDataMode===J.Invariant)continue;if(e!==s)continue;a=!0}else{if("js-module-dotnet"===t)continue;if("dotnetwasm"===t)continue}const r={name:e,resolvedUrl:T.locateFile(e),hash:o.runtime[e],behavior:t};n.push(r)}for(let e=0;e<H.bootConfig.config.length;e++){const o=H.bootConfig.config[e];"appsettings.json"!==o&&o!==`appsettings.${t}.json`||n.push({name:o,resolvedUrl:(document?document.baseURI:"/")+o,behavior:"vfs"})}a||(e.globalizationMode="invariant"),H.bootConfig.modifiableAssemblies&&(r.DOTNET_MODIFIABLE_ASSEMBLIES=H.bootConfig.modifiableAssemblies),H.startOptions.applicationCulture&&(r.LANG=`${H.startOptions.applicationCulture}.UTF-8`),void 0!==H.bootConfig.startupMemoryCache&&(e.startupMemoryCache=H.bootConfig.startupMemoryCache),H.bootConfig.runtimeOptions&&(e.runtimeOptions=[...e.runtimeOptions||[],...H.bootConfig.runtimeOptions||[]])}(T.config,e.applicationEnvironment),function(e){T.downloadResource=t=>{const o=Y[t.behavior];if(void 0!==o){const n=H.loadResource(t.name,t.resolvedUrl,t.hash,o);return t.pendingDownload=n,Z++,n.response.then((()=>{G++,e.onDownloadResourceProgress&&e.onDownloadResourceProgress(G,Z)})),n}},e.disableDotnet6Compatibility=!1}(t)}!function(e){e[e.Sharded=0]="Sharded",e[e.All=1]="All",e[e.Invariant=2]="Invariant",e[e.Custom=3]="Custom",e[e.Hybrid=4]="Hybrid"}(J||(J={}));let G=0,Z=0;const K=e=>"dotnet.native.wasm"===e?"dotnetwasm":e.startsWith("dotnet.native.worker")&&e.endsWith(".js")?"js-module-threads":e.startsWith("dotnet.native")&&e.endsWith(".js")?"js-module-native":e.startsWith("dotnet.runtime")&&e.endsWith(".js")?"js-module-runtime":e.startsWith("dotnet")&&e.endsWith(".js")?"js-module-dotnet":e.startsWith("icudt")?"icu":"other",Y={assembly:"assembly",pdb:"pdb",icu:"globalization",vfs:"configuration",dotnetwasm:"dotnetwasm"};function X(e,t){const o={...t};return o.assets&&(o.assets=[...e.assets||[],...o.assets||[]]),o.environmentVariables&&(o.environmentVariables={...e.environmentVariables||{},...o.environmentVariables||{}}),o.startupOptions&&(o.startupOptions={...e.startupOptions||{},...o.startupOptions||{}}),o.runtimeOptions&&(o.runtimeOptions=[...e.runtimeOptions||[],...o.runtimeOptions||[]]),Object.assign(e,o)}function ee(e,t){const o={...t};return o.config&&(e.config||(e.config={}),o.config=X(e.config,o.config)),Object.assign(e,o)}function te(){const e=T.config;e.environmentVariables=e.environmentVariables||{},e.assets=e.assets||[],e.runtimeOptions=e.runtimeOptions||[],e.globalizationMode=e.globalizationMode||"auto",void 0===e.debugLevel&&"Debug"===$&&(e.debugLevel=-1),void 0===e.diagnosticTracing&&"Debug"===$&&(e.diagnosticTracing=!0),R.diagnosticTracing=T.diagnosticTracing=!!e.diagnosticTracing,T.assetUniqueQuery=e.assetUniqueQuery,R.waitForDebugger=e.waitForDebugger,e.startupMemoryCache=!!e.startupMemoryCache,e.startupMemoryCache&&R.waitForDebugger&&(i("Disabling startupMemoryCache because waitForDebugger is set"),e.startupMemoryCache=!1),R.enablePerfMeasure=!!e.browserProfilerOptions&&globalThis.performance&&"function"==typeof globalThis.performance.measure}let oe,ne,re=!1;async function ie(e){var t;if(T.scriptUrl=import.meta.url.replace(/\\/g,"/").replace(/[?#].*/,""),T.scriptDirectory=(t=T.scriptUrl).slice(0,t.lastIndexOf("/"))+"/",T.locateFile=e=>function(e){return A||j?e.startsWith("/")||e.startsWith("\\")||-1!==e.indexOf("///")||le.test(e):ce.test(e)}(e)?e:T.scriptDirectory+e,T.downloadResource=e.downloadResource,T.fetch_like=ae,T.out=console.log,T.err=console.error,T.getApplicationEnvironment=e.getApplicationEnvironment,O&&globalThis.navigator){const e=globalThis.navigator,t=e.userAgentData&&e.userAgentData.brands;t&&t.length>0?T.isChromium=t.some((e=>"Google Chrome"===e.brand||"Microsoft Edge"===e.brand||"Chromium"===e.brand)):e.userAgent&&(T.isChromium=e.userAgent.includes("Chrome"),T.isFirefox=e.userAgent.includes("Firefox"))}S.require=A?await import("module").then((e=>e.createRequire(import.meta.url))):Promise.resolve((()=>{throw new Error("require not supported")})),void 0===globalThis.URL&&(globalThis.URL=class{constructor(e){this.url=e}toString(){return this.url}})}const se="function"==typeof globalThis.fetch;async function ae(e,t){try{if(A){const o=e.startsWith("file://");if(!o&&se)return globalThis.fetch(e,t||{credentials:"same-origin"});oe||(ne=S.require("url"),oe=S.require("fs")),o&&(e=ne.fileURLToPath(e));const n=await oe.promises.readFile(e);return{ok:!0,headers:[],url:e,arrayBuffer:()=>n,json:()=>JSON.parse(n),text:()=>{throw new Error("NotImplementedException")}}}if(se)return globalThis.fetch(e,t||{credentials:"same-origin"});if("function"==typeof read)return{ok:!0,url:e,arrayBuffer:()=>new Uint8Array(read(e,"binary")),json:()=>JSON.parse(read(e,"utf8")),text:()=>read(e,"utf8")}}catch(t){return{ok:!1,url:e,status:500,statusText:"ERR28: "+t,arrayBuffer:()=>{throw t},json:()=>{throw t},text:()=>{throw t}}}throw new Error("No fetch implementation available")}const ce=/^[a-zA-Z][a-zA-Z\d+\-.]*?:\/\//,le=/[a-zA-Z]:[\\/]/;const de="__mono_message_please_dont_collide__";let ue=!1;const fe=M.module,he=fe.config;async function me(e){if("function"==typeof e){const t=e(M.api);if(t.ready)throw new Error("Module.ready couldn't be redefined.");Object.assign(fe,t),ee(fe,t)}else{if("object"!=typeof e)throw new Error("Can't use moduleFactory callback of createDotnetRuntime function.");ee(fe,e)}return fe.ENVIRONMENT_IS_PTHREAD?async function(){await ie(fe),function(){const e=new MessageChannel,t=e.port1,o=e.port2;t.addEventListener("message",(e=>{var n;n=JSON.parse(e.data.config),ue?i("mono config already received"):(X(T.config,n),te(),i("mono config received"),ue=!0,T.afterConfigLoaded.promise_control.resolve(T.config),O&&n.forwardConsoleLogsToWS&&void 0!==globalThis.WebSocket&&T.setup_proxy_console("pthread-worker",console,self.location.href)),t.close(),o.close()}),{once:!0}),t.start(),self.postMessage({[de]:{monoCmd:"preload",port:o}},[o])}(),await T.afterConfigLoaded.promise;const e=pe();return ge(await Promise.all(e)),fe}():async function(){await ie(fe),fe.configSrc||fe.config&&0!==Object.keys(fe.config).length&&fe.config.assets||(-1==T.scriptDirectory.indexOf("/_framework")?fe.configSrc="./_framework/blazor.boot.json":fe.configSrc="./blazor.boot.json"),await async function(e){var t,o,n;const r=e.configSrc;if(re)await T.afterConfigLoaded.promise;else{if(re=!0,!r)return te(),void T.afterConfigLoaded.promise_control.resolve(T.config);i("mono_wasm_load_config");try{if(T.config.applicationEnvironment=null!==(n=null!==(t=T.config.applicationEnvironment)&&void 0!==t?t:null===(o=T.config.startupOptions)||void 0===o?void 0:o.environment)&&void 0!==n?n:"Production",T.config.startupOptions&&T.config.startupOptions.loadBootResource)await async function(e,t){var o;const n=P.initAsync(null===(o=e.startupOptions)||void 0===o?void 0:o.loadBootResource,e.applicationEnvironment),r=await n;await Q(r,t,e.startupOptions)}(T.config,e);else{const t=T.locateFile(r),o=await T.fetch_like(t),n=await o.json()||{};if(n.resources)await Q(P.fromFetchResponse(o,n,T.config.applicationEnvironment),e,T.config.startupOptions);else{const e=n;if(e.environmentVariables&&"object"!=typeof e.environmentVariables)throw new Error("Expected config.environmentVariables to be unset or a dictionary-style object");X(T.config,e)}}if(te(),e.onConfigLoaded)try{await e.onConfigLoaded(T.config,I),te()}catch(e){throw a("onConfigLoaded() failed",e),e}T.afterConfigLoaded.promise_control.resolve(T.config)}catch(t){const o=`Failed to load config file ${r} ${t}`;throw T.config=e.config={message:o,error:t,isError:!0},T.abort_startup(o,!0),t}}}(fe);const e=pe();return y(w("dotnetwasm")).then((e=>{T.wasmDownloadPromise.promise_control.resolve(e)})),function(){if(T.invariantMode="invariant"===T.config.globalizationMode,T.preferredIcuAsset=function(){if(!T.config.assets||T.invariantMode)return null;const e=T.config.assets.filter((e=>"icu"==e.behavior));if(1===e.length)return e[0].name;const t=O?navigator.language:Intl.DateTimeFormat().resolvedOptions().locale,o=t.split("-")[0];return"en"==o||["fr","fr-FR","it","it-IT","de","de-DE","es","es-ES"].includes(t)?"icudt_EFIGS.dat":["zh","ko","ja"].includes(o)?"icudt_CJK.dat":"icudt_no_CJK.dat"}(),!T.invariantMode)if(T.preferredIcuAsset)i("ICU data archive(s) available, disabling invariant mode");else{if("icu"===T.config.globalizationMode){const e="invariant globalization mode is inactive and no ICU data archives are available";throw T.err(`ERROR: ${e}`),new Error(e)}i("ICU data archive(s) not available, using invariant globalization mode"),T.invariantMode=!0,T.preferredIcuAsset=null}const e="DOTNET_SYSTEM_GLOBALIZATION_INVARIANT",t="DOTNET_SYSTEM_GLOBALIZATION_HYBRID",o=T.config.environmentVariables;if(void 0===o[t]&&"hybrid"===T.config.globalizationMode?o[t]="1":void 0===o[e]&&T.invariantMode&&(o[e]="1"),void 0===o.TZ)try{const e=Intl.DateTimeFormat().resolvedOptions().timeZone||null;e&&(o.TZ=e)}catch(e){!function(e,...t){console.info(r+e,...t)}("failed to detect timezone, will fallback to UTC")}}(),ge(await Promise.all(e)),await R.dotnetReady.promise,I}()}function pe(){return R.runtimeModuleUrl=w("js-module-runtime").resolvedUrl,R.nativeModuleUrl=w("js-module-native").resolvedUrl,[import(R.runtimeModuleUrl),import(R.nativeModuleUrl)]}function ge(e){const{initializeExports:t,initializeReplacements:o,configureEmscriptenStartup:n,configureWorkerStartup:r,setRuntimeGlobals:i,passEmscriptenInternals:s}=e[0],{default:a}=e[1];i(M),t(M),T.runtimeModuleLoaded.promise_control.resolve(),a((e=>(Object.assign(fe,{ready:e.ready,__dotnet_runtime:{initializeReplacements:o,configureEmscriptenStartup:n,configureWorkerStartup:r,passEmscriptenInternals:s}}),fe)))}const we=new class{withModuleConfig(e){try{return ee(fe,e),this}catch(e){throw k(1,e),e}}withConsoleForwarding(){try{return X(he,{forwardConsoleLogsToWS:!0}),this}catch(e){throw k(1,e),e}}withExitOnUnhandledError(){const e=function(e,t){e.preventDefault();try{t&&t.silent||k(1,t)}catch(e){}};try{return O&&(window.addEventListener("unhandledrejection",(t=>e(t,t.reason))),window.addEventListener("error",(t=>e(t,t.error)))),this}catch(e){throw k(1,e),e}}withAsyncFlushOnExit(){try{return X(he,{asyncFlushOnExit:!0}),this}catch(e){throw k(1,e),e}}withExitCodeLogging(){try{return X(he,{logExitCode:!0}),this}catch(e){throw k(1,e),e}}withElementOnExit(){try{return X(he,{appendElementOnExit:!0}),this}catch(e){throw k(1,e),e}}withWaitingForDebugger(e){try{return X(he,{waitForDebugger:e}),this}catch(e){throw k(1,e),e}}withStartupMemoryCache(e){try{return X(he,{startupMemoryCache:e}),this}catch(e){throw k(1,e),e}}withConfig(e){try{return X(he,e),this}catch(e){throw k(1,e),e}}withConfigSrc(e){try{if(!e||"string"!=typeof e)throw new Error("Assert failed: must be file path or URL");return ee(fe,{configSrc:e}),this}catch(e){throw k(1,e),e}}withVirtualWorkingDirectory(e){try{if(!e||"string"!=typeof e)throw new Error("Assert failed: must be directory path");return this.virtualWorkingDirectory=e,this}catch(e){throw k(1,e),e}}withEnvironmentVariable(e,t){try{const o={};return o[e]=t,X(he,{environmentVariables:o}),this}catch(e){throw k(1,e),e}}withEnvironmentVariables(e){try{if(!e||"object"!=typeof e)throw new Error("Assert failed: must be dictionary object");return X(he,{environmentVariables:e}),this}catch(e){throw k(1,e),e}}withDiagnosticTracing(e){try{if("boolean"!=typeof e)throw new Error("Assert failed: must be boolean");return X(he,{diagnosticTracing:e}),this}catch(e){throw k(1,e),e}}withDebugging(e){try{if(!e||"number"!=typeof e)throw new Error("Assert failed: must be number");return X(he,{debugLevel:e}),this}catch(e){throw k(1,e),e}}withApplicationArguments(...e){try{if(!e||!Array.isArray(e))throw new Error("Assert failed: must be array of strings");return this.applicationArguments=e,this}catch(e){throw k(1,e),e}}withRuntimeOptions(e){try{if(!e||!Array.isArray(e))throw new Error("Assert failed: must be array of strings");return X(he,{runtimeOptions:e}),this}catch(e){throw k(1,e),e}}withMainAssembly(e){try{return X(he,{mainAssemblyName:e}),this}catch(e){throw k(1,e),e}}withApplicationArgumentsFromQuery(){try{if(!globalThis.window)throw new Error("Missing window to the query parameters from");if(void 0===globalThis.URLSearchParams)throw new Error("URLSearchParams is supported");const e=new URLSearchParams(window.location.search).getAll("arg");return this.withApplicationArguments(...e)}catch(e){throw k(1,e),e}}withStartupOptions(e){return X(he,{startupOptions:e}),this}async create(){try{if(!this.instance){if(O&&fe.config.forwardConsoleLogsToWS&&void 0!==globalThis.WebSocket&&d("main",globalThis.console,globalThis.location.origin),A){const e=await import("process");if(e.versions.node.split(".")[0]<14)throw new Error(`NodeJS at '${e.execPath}' has too low version '${e.versions.node}'`)}if(!fe)throw new Error("Assert failed: Null moduleConfig");if(!fe.config)throw new Error("Assert failed: Null moduleConfig.config");await me(fe),this.instance=M.api}if(this.virtualWorkingDirectory){const e=this.instance.Module.FS,t=e.stat(this.virtualWorkingDirectory);if(!t||!e.isDir(t.mode))throw new Error(`Assert failed: Could not find working directory ${this.virtualWorkingDirectory}`);e.chdir(this.virtualWorkingDirectory)}return this.instance}catch(e){throw k(1,e),e}}async run(){try{if(!fe.config)throw new Error("Assert failed: Null moduleConfig.config");if(this.instance||await this.create(),!fe.config.mainAssemblyName)throw new Error("Assert failed: Null moduleConfig.config.mainAssemblyName");if(!this.applicationArguments)if(A){const e=await import("process");this.applicationArguments=e.argv.slice(2)}else this.applicationArguments=[];return this.instance.runMainAndExit(fe.config.mainAssemblyName,this.applicationArguments)}catch(e){throw k(1,e),e}}},be=k,ye=me;export{ye as default,we as dotnet,be as exit};
